load '~/code/aoc/aoc.ijs'

in =: (<;._2~ (2#LF)&E.) (aoc 2020 19),LF
Q =: {{ (r=_) {:: y;r=._".y }}
P =: [: (([: }.&.>{.),}.) [: <@".;._1'|',]
O =: /: ". > {."1 ([: <;._1 ' ',]);._1 ] (#~ ~:&':') LF,0{::in
S =: <;._1 ] 1{::in
R =: P &.> O { <;._1 ] (#~ ~:&':') LF,0{::in

E =: <"1 (#~ _ ~: {:"1) ; (,.&.>/)"1 (,.~ [: <"0 i.@#) /:~@~.@; &.> R
G =: 1 E}0$~,~#R

F =: 3 : 0
 y{R
)

F 57
